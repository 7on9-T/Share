Day24 安全开发-PHP应用&文件管理模块&显示上传&黑白名单类型过滤&访问控制
-
前置知识：
$_FILES:PHP中一个预定义的超全局变量，用于在上传文件时从客户端接收文件，并将其保存在服务器上。他是一个包含上传文件信息的数组，包括文件名、类型、大小、临时文件名等信息。
$_FILES[“表单值”][“name”]获取上传文件原始名称
$_FILES[“表单值”][“type”]获取上传文件MIME类型
$_FILES[“表单值”][“size”]获取上传文件字节单位大小
$_FILES[“表单值”][“tmp_name”]获取上传的临时副本文件名
$_FILES[“表单值”][“error”]获取上传时发生的错误代码
move_uploaded_file()将上传的文件移动到指定位置的函数

后缀黑名单
后缀白名单
MIME白名单

安全问题：BurpSuite修改数据包实现绕过
 
上图对请求的包的文件名和MIME类型进行修改。
可以绕过预先设置的MIME白名单。
并成功上传后门文件。

文件管理功能
显示 上传 下载 删除 编辑 包含等
1.打开目录读取文件列表
2.递归循环读取文件列表
3.判断是文件还是文件夹
4.php.ini目录访问控制

is_dir()函数用于检查路径是否是一个目录
opendir()函数用于打开指定目录，返回句柄，用来读取目录中的文件和子目录
readdir()函数用于从打开的目录句柄4E2D读取目录中的文件和子目录
open_basedir : php.ini中的设置用来控制脚本程序访问目录。
http://127.0.0.1/upload/manage.php?path=c:\windows\system32
安全问题：跨目录进行访问。
 
需要进行过滤
在php.ini进行设置open_basedir = D:\phpstudy_pro\WWW
完成此操作后需要重启Web服务器。
 
此时再次访问，就会被拒。
